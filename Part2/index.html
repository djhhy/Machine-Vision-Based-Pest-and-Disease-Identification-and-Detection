<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>农作物病害知识库 - 智慧农业大创项目</title>
    <meta name="description" content="智慧农业大创项目 - 基于机器视觉的病虫识别与应用，提供多种农作物病害知识、防治方案和农业技术指导">
    <meta name="keywords" content="农业,病害防治,智慧农业,病虫识别,番茄,水稻,玉米,小麦">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
</head>
<body>
    <!-- 加载动画 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-leaf"></i>
            </div>
            <div class="loading-spinner"></div>
            <div class="loading-text">
                正在加载病害知识库
                <span class="loading-dots"></span>
            </div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
            <p style="color: #888; font-size: 0.9rem; margin-top: 0.5rem;">
                基于机器视觉的病虫识别与应用
            </p>
            <div class="loading-tips">
                <p><small>提示: 按 / 键可快速搜索，ESC 关闭弹窗</small></p>
            </div>
        </div>
    </div>

    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-leaf"></i>
                <span>智慧农业病害知识库</span>
                <span class="compare-badge" id="compareBadge" style="display: none;">0</span>
            </div>
            <div class="nav-links">
                <a href="..\index.html" class="active"><i class="fas fa-home"></i> 首页</a>
                <a href="index.html"><i class="fas fa-seedling"></i> 病害库</a>
                <a href="#" id="imageGalleryTrigger"><i class="fas fa-images"></i> 图像库</a>
                <a href="#" id="filterTrigger"><i class="fas fa-filter"></i> 筛选</a>
                <a href="#" id="searchTrigger"><i class="fas fa-search"></i> 搜索</a>
                <a href="#" id="favoritesLink"><i class="fas fa-star"></i> 收藏 <span class="favorites-count">0</span></a>
            </div>
            <button class="mobile-menu-btn" aria-label="菜单">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- 筛选框（默认隐藏） -->
    <div class="filter-overlay" id="filterOverlay">
        <div class="filter-modal">
            <div class="filter-modal-header">
                <h3><i class="fas fa-filter"></i> 高级筛选</h3>
                <button class="filter-close" id="filterClose" aria-label="关闭筛选">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="filter-modal-body">
                <!-- 四重筛选条件 -->
                <div class="filter-conditions">
                    <!-- 危害程度筛选 -->
                    <div class="filter-group">
                        <label><i class="fas fa-exclamation-triangle"></i> 危害程度:</label>
                        <div class="filter-tags">
                            <button class="filter-tag severity-tag active" data-severity="all">全部</button>
                            <button class="filter-tag severity-tag" data-severity="high">
                                <i class="fas fa-skull-crossbones"></i> 高危害
                            </button>
                            <button class="filter-tag severity-tag" data-severity="medium">
                                <i class="fas fa-exclamation-circle"></i> 中危害
                            </button>
                            <button class="filter-tag severity-tag" data-severity="low">
                                <i class="fas fa-info-circle"></i> 低危害
                            </button>
                        </div>
                    </div>

                    <!-- 危害作物筛选 -->
<div class="filter-group">
    <label><i class="fas fa-seedling"></i> 危害作物:</label>
    <div class="filter-tags">
        <button class="filter-tag crop-tag active" data-crop="all">全部</button>
        <button class="filter-tag crop-tag" data-crop="苹果">苹果</button>
        <button class="filter-tag crop-tag" data-crop="玉米">玉米</button>
        <button class="filter-tag crop-tag" data-crop="葡萄">葡萄</button>
        <button class="filter-tag crop-tag" data-crop="甜椒">甜椒</button>
        <button class="filter-tag crop-tag" data-crop="马铃薯">马铃薯</button>
        <button class="filter-tag crop-tag" data-crop="番茄">番茄</button>
    </div>
</div>

                    <!-- 病原类型筛选 -->
                    <div class="filter-group">
                        <label><i class="fas fa-virus"></i> 病原类型:</label>
                        <div class="filter-tags">
                            <button class="filter-tag pathogen-tag active" data-pathogen="all">全部</button>
                            <button class="filter-tag pathogen-tag" data-pathogen="真菌">真菌病害</button>
                            <button class="filter-tag pathogen-tag" data-pathogen="细菌">细菌病害</button>
                            <button class="filter-tag pathogen-tag" data-pathogen="病毒">病毒病害</button>
                        </div>
                    </div>

                    <!-- 易发条件筛选 -->
                    <div class="filter-group">
                        <label><i class="fas fa-cloud-sun"></i> 易发条件:</label>
                        <div class="filter-tags">
                            <button class="filter-tag condition-tag active" data-condition="all">全部</button>
                            <button class="filter-tag condition-tag" data-condition="高温高湿">高温高湿</button>
                            <button class="filter-tag condition-tag" data-condition="低温高湿">低温高湿</button>
                            <button class="filter-tag condition-tag" data-condition="连作">连作</button>
                            <button class="filter-tag condition-tag" data-condition="雨季">雨季</button>
                            <button class="filter-tag condition-tag" data-condition="通风不良">通风不良</button>
                            <button class="filter-tag condition-tag" data-condition="密植">密植</button>
                            <button class="filter-tag condition-tag" data-condition="氮肥过多">氮肥过多</button>
                            <button class="filter-tag condition-tag" data-condition="植株生长过旺">植株生长过旺</button>
                            <button class="filter-tag condition-tag" data-condition="温暖多雨">温暖多雨</button>
                        </div>
                    </div>
                </div>

                <!-- 筛选操作按钮 -->
                <div class="filter-actions">
                    <button id="applyFilter" class="btn-primary">
                        <i class="fas fa-check"></i> 应用筛选
                    </button>
                    <button id="resetFilter" class="btn-secondary">
                        <i class="fas fa-redo"></i> 重置筛选
                    </button>
                </div>

                <!-- 当前筛选状态显示 -->
                <div class="filter-status" id="filterStatus">
                    <h4><i class="fas fa-list"></i> 当前筛选条件:</h4>
                    <div class="status-tags" id="currentFilters">
                        <span class="status-tag">全部病害</span>
                    </div>
                </div>

                <!-- 筛选结果统计 -->
                <div class="filter-stats">
                    <div class="stat-item">
                        <i class="fas fa-leaf"></i>
                        <span>符合条件病害: <strong id="filteredCount">0</strong> 个</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 搜索框（默认隐藏） -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-modal">
            <div class="search-modal-header">
                <h3><i class="fas fa-search"></i> 搜索病害</h3>
                <button class="search-close" id="searchClose" aria-label="关闭搜索">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="search-modal-body">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="搜索病害名称、症状或作物类型... (按回车搜索)">
                    <button id="searchBtn" aria-label="搜索病害">搜索</button>
                </div>
<div class="search-hot-keywords">
    <label>热门搜索:</label>
    <div class="keyword-tags">
        <button class="keyword-tag" data-keyword="黑星病">黑星病</button>
        <button class="keyword-tag" data-keyword="晚疫病">晚疫病</button>
        <button class="keyword-tag" data-keyword="叶霉病">叶霉病</button>
        <button class="keyword-tag" data-keyword="细菌性斑点病">细菌性斑点病</button>
        <button class="keyword-tag" data-keyword="靶斑病">靶斑病</button>
    </div>
</div>
                <div class="search-help">
                    <p><i class="fas fa-info-circle"></i> 提示: 按 <kbd>ESC</kbd> 关闭搜索，<kbd>/</kbd> 打开搜索</p>
                </div>
            </div>
        </div>
    </div>

    <div id="searchSuggestions" class="search-suggestions"></div>

    <!-- 主内容 -->
    <main class="main-content" id="diseases">
        <div class="container">
            <div class="page-header" id="home">
                <h1><i class="fas fa-book-medical"></i> 农作物病害知识库</h1>
                <div class="stats">
                    <div class="stat-item">
                        <i class="fas fa-bug"></i>
                        <span>病害总数: <strong id="diseaseCount">21</strong></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-seedling"></i>
                        <span>作物类型: <strong>6</strong></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-star"></i>
                        <span>已收藏: <strong id="favoritesCount">0</strong></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-balance-scale"></i>
                        <span>对比中: <strong id="compareCount">0</strong></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-images"></i>
                        <span>病害图像: <strong id="imageCount">加载中...</strong></span>
                    </div>
                </div>
            </div>
            
            <!-- 对比工具栏 -->
            <div class="compare-toolbar" id="compareToolbar" style="display: none;">
                <div class="compare-header">
                    <h3><i class="fas fa-balance-scale"></i> 病害对比 (最多选择4个)</h3>
                    <div class="compare-actions">
                        <button id="clearCompare" class="btn-secondary">清空</button>
                        <button id="startCompare" class="btn-primary">开始对比</button>
                    </div>
                </div>
                <div class="compare-list" id="compareList">
                    <!-- 对比项将通过JS动态加载 -->
                </div>
            </div>

            <!-- 病害卡片网格 -->
            <div class="disease-grid" id="diseaseGrid">
                <!-- 卡片将通过JS动态加载 -->
            </div>
        </div>
    </main>

    <!-- 详细信息模态框 -->
    <div class="modal" id="diseaseModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">病害详情</h2>
                <button class="modal-close" aria-label="关闭">&times;</button>
            </div>
            <div class="modal-body">
                <!-- 详情内容将通过JS动态加载 -->
            </div>
        </div>
    </div>

    <!-- 回到顶部按钮 -->
    <button class="back-to-top" id="backToTop" aria-label="回到顶部">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- 对比模态框 -->
    <div class="modal" id="compareModal" role="dialog" aria-modal="true" aria-labelledby="compareModalTitle">
        <div class="modal-content compare-modal-content">
            <div class="modal-header">
                <h2 id="compareModalTitle"><i class="fas fa-balance-scale"></i> 病害对比分析</h2>
                <button class="modal-close" aria-label="关闭">&times;</button>
            </div>
            <div class="modal-body" id="compareModalBody">
                <!-- 对比内容将通过JS动态加载 -->
            </div>
        </div>
    </div>

    <!-- 图像库模态框 -->
    <div class="modal image-gallery-modal" id="imageGalleryModal" style="display: none;">
        <div class="modal-content" style="max-width: 1400px;">
            <div class="modal-header">
                <h2><i class="fas fa-images"></i> 病害图像库</h2>
                <div class="modal-header-actions">
                    <button class="btn-secondary" id="closeGallery">
                        <i class="fas fa-times"></i> 关闭
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="gallery-controls">
                    <div class="gallery-search">
                        <i class="fas fa-search"></i>
                        <input type="text" id="imageSearch" placeholder="搜索作物或病害...">
                        <button class="btn-small" id="clearSearch">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="gallery-filters">
                        <div class="filter-group">
                            <label><i class="fas fa-seedling"></i> 作物:</label>
                            <select id="filterCrop">
                                <option value="all">全部作物</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-virus"></i> 病害:</label>
                            <select id="filterDisease">
                                <option value="all">全部病害</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-filter"></i> 类型:</label>
                            <select id="filterType">
                                <option value="all">全部类型</option>
                                <option value="真菌">真菌病害</option>
                                <option value="细菌">细菌病害</option>
                                <option value="病毒">病毒病害</option>
                                <option value="虫害">虫害</option>
                                <option value="健康">健康植株</option>
                            </select>
                        </div>
                        <button class="btn-primary" id="applyFilters">
                            <i class="fas fa-filter"></i> 应用筛选
                        </button>
                        <button class="btn-secondary" id="resetFilters">
                            <i class="fas fa-redo"></i> 重置
                        </button>
                    </div>
                </div>
                
                <div class="gallery-stats">
                    <span><i class="fas fa-image"></i> 总数: <strong id="totalImages">0</strong></span>
                    <span><i class="fas fa-filter"></i> 筛选: <strong id="filteredImages">0</strong></span>
                    <span><i class="fas fa-eye"></i> 已选: <strong id="selectedImages">0</strong></span>
                </div>
                
                <div class="gallery-grid" id="galleryGrid">
                    <!-- 图像将通过JS动态加载 -->
                </div>
                
                <div class="gallery-pagination" id="galleryPagination">
                    <!-- 分页控件 -->
                </div>
                
                <div class="gallery-actions">
                    <button class="btn-primary" id="viewSelected">
                        <i class="fas fa-eye"></i> 查看选中
                    </button>
                    <button class="btn-secondary" id="clearSelected">
                        <i class="fas fa-trash"></i> 清除选择
                    </button>
                    <button class="btn-primary" id="startSlideshow">
                        <i class="fas fa-play"></i> 幻灯片播放
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 图像查看器模态框 -->
    <div class="modal image-viewer-modal" id="imageViewerModal" style="display: none;">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h2 id="imageTitle">病害图像查看</h2>
                <div class="modal-header-actions">
                    <button class="image-nav-btn" id="prevImage" title="上一张">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="imageCounter">1 / 10</span>
                    <button class="image-nav-btn" id="nextImage" title="下一张">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="image-action-btn" id="zoomIn" title="放大">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="image-action-btn" id="zoomOut" title="缩小">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button class="image-action-btn" id="toggleFullscreen" title="全屏">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="image-action-btn" id="downloadImage" title="下载">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="image-action-btn" id="closeImageViewer" title="关闭">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="image-viewer-container">
                    <div class="image-display-area" id="imageDisplayArea">
                        <img id="currentImageView" src="" alt="病害图像">
                        <div class="image-loading" id="imageLoading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>加载图像中...</p>
                        </div>
                    </div>
                    
                    <div class="image-info-panel">
                        <div class="image-info-section">
                            <h3><i class="fas fa-info-circle"></i> 图像信息</h3>
                            <div class="info-item">
                                <strong>作物:</strong>
                                <span id="infoCrop">番茄</span>
                            </div>
                            <div class="info-item">
                                <strong>病害:</strong>
                                <span id="infoDisease">早疫病</span>
                            </div>
                            <div class="info-item">
                                <strong>病害类型:</strong>
                                <span id="infoType" class="disease-type-tag">真菌</span>
                            </div>
                            <div class="info-item">
                                <strong>健康状态:</strong>
                                <span id="infoHealth" class="health-status healthy">健康</span>
                            </div>
                            <div class="info-item">
                                <strong>图像ID:</strong>
                                <span id="infoId">1</span>
                            </div>
                        </div>
                        
                        <div class="image-info-section">
                            <h3><i class="fas fa-clipboard-list"></i> 识别特征</h3>
                            <div class="recognition-features" id="recognitionFeatures">
                                <p>基于机器视觉识别系统提取的特征信息...</p>
                            </div>
                        </div>
                        
                        <div class="image-info-section">
                            <h3><i class="fas fa-cogs"></i> 图像控制</h3>
                            <div class="control-group">
                                <label>缩放级别:</label>
                                <div class="zoom-levels">
                                    <button class="zoom-level-btn active" data-zoom="1">1x</button>
                                    <button class="zoom-level-btn" data-zoom="1.5">1.5x</button>
                                    <button class="zoom-level-btn" data-zoom="2">2x</button>
                                    <button class="zoom-level-btn" data-zoom="3">3x</button>
                                </div>
                            </div>
                            <div class="control-group">
                                <label>幻灯片播放:</label>
                                <button class="btn-small" id="toggleSlideshow">
                                    <i class="fas fa-play"></i> 开始播放
                                </button>
                                <input type="range" id="slideshowSpeed" min="1" max="10" value="5">
                                <span id="speedValue">5秒</span>
                            </div>
                        </div>
                        
                        <div class="image-actions">
                            <button class="btn-primary" id="compareWithSimilar">
                                <i class="fas fa-balance-scale"></i> 对比相似病害
                            </button>
                            <button class="btn-secondary" id="viewInGallery">
                                <i class="fas fa-images"></i> 返回图库
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="thumbnail-strip" id="thumbnailStrip">
                    <!-- 缩略图条 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3><i class="fas fa-leaf"></i> 智慧农业病害知识库</h3>
                <p>基于机器视觉的病虫害识别与应用</p>
                <p>大创项目 - 助力农业智能化发展</p>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-book"></i> 数据来源</h3>
                <p>病害数据: 农业科学文献</p>
                <p>图像数据: PlantVillage数据集</p>
                <p>知识库: 专家知识图谱</p>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-keyboard"></i> 快捷键</h3>
                <p><kbd>/</kbd> 打开搜索</p>
                <p><kbd>ESC</kbd> 关闭弹窗</p>
                <p><kbd>F</kbd> 全屏切换</p>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-images"></i> 图像库功能</h3>
                <p>浏览真实病害图像</p>
                <p>支持对比分析</p>
                <p>智能病害识别</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 智慧农业大创项目 - 基于机器视觉的病虫识别与应用 | 数据版本: 2.0 | 最后更新: <span id="lastUpdated">2024-01-01</span></p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>